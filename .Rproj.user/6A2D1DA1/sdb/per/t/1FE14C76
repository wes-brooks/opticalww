{
    "contents" : "library(mgcv)\n\n#for observation i, extract the values of the excitation-emission spectrum\ncc = matrix(NA,0,100)\nm = list()\nfor (i in 51:55) {\n    cat(paste(i, \"\\n\", sep=\"\"))\n    \n    eem = cbind(freqs, t(ss[i,indx]))\n    rownames(eem) = NULL\n    colnames(eem)[3] = 'val'\n\n    anomaly = eem$val - rm\n    anomaly = cbind(freqs, anomaly)\n    \n    m[[i]] = gam(anomaly~s(excite, emit, k=100), data=anomaly, family=gaussian)\n    cc = rbind(cc, coef(m[[i]]))\n}\ncolnames(cc) = NULL\n\n#Center and scale the columns:\ncm = colMeans(cc)\ncc = sweep(cc, 2, cm, '-')\n\nnorm = apply(cc, 2, function(x) sum(x**2))\ncc = sweep(cc, 2, norm**(-0.5), '*')\n\ny = log(ss$Bac.human+1)[1:50]\ncorrelations = abs(y %*% cc)\nindx = order(correlations, decreasing=TRUE)\n\n#Add the BacHum counts:\n#cc = cbind(log(ss$Bac.human[1:10]), cc)\n#colnames(cc)[1] = \"Bac.human\"\n\n",
    "created" : 1414509347269.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "769497265",
    "id" : "1FE14C76",
    "lastKnownWriteTime" : 1414530373,
    "path" : "C:/Users/wrbrooks/git/eem/R/spline.r",
    "project_path" : "R/spline.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}